/**
 * 
 */
package training.daniel.IO;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

/**
 * @author dmoench
 * 
 */
public class CSVLoader
{
    private final String columnSep;

    public CSVLoader(String columnSep)
    {
        this.columnSep = columnSep;
    }

    public List<List<String>> load(String filePath)
    {
        List<List<String>> result = new ArrayList<>();

        StringFileReader fileReader = new StringFileReader();
        try
        {
        List<String> lines = fileReader.readAllLines(filePath);
        }
        catch(IOException e)
        {
            throw new RuntimeException("Can't load file: " + filePath);
        }

        int size = lines.size();
        for (int i = 0; i < size; i++)
        {
            String dataRow = lines.get(i);
            String[] dataArray = dataRow.split(columnSep);
            List<String> row = new ArrayList<>(dataArray.length + 1);
            row.add(String.valueOf(i));
            row.addAll(Arrays.asList(dataArray));
            result.add(row);
            i++;
        }
        return result;
    }
}
